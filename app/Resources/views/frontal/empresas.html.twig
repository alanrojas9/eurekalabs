{#Planilla de nuestra aplicacion#}
{% extends 'base.html.twig' %}
{#Titulo de Pagina#}
{% block title %}  Pagina cotización  {% endblock %}
{#Contenido#}
{% block body %}
	<br>
	<div class="container">
    <!-- Page Heading/Breadcrumbs -->
      <h1 class="mt-4 mb-3">Nuestras
        <small>Empresas</small>
      </h1>
      <small>Haga click en la empresa que desea ver su cotizacion</small>
    <!-- /.row -->
    <br>
    <br>
	<!-- Contact Details Column -->
	<!-- Empresa Facebook -->
	{% if nom_empr == 'FB' or nom_empr == 'todas' %}
		<div class="panel-body">
        <div class="row">
            <div class="col-lg-12">
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover table-striped">
                            <thead>
                            <tr>
                                <th>Empresa Faceboob</th>
                                <th>Cotización del día</th>
                                <th>Apertura</th>
                                <th>Cierre</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>3326</td>
                                <td>10/21/2013</td>
                                <td>3:29 PM</td>
                                <td>$321.33</td>
                            </tr>
                            <tr>
                                <td>3325</td>
                                <td>10/21/2013</td>
                                <td>3:20 PM</td>
                                <td>$234.34</td>
                            </tr>
                            <tr>
                                <td>3324</td>
                                <td>10/21/2013</td>
                                <td>3:03 PM</td>
                                <td>$724.17</td>
                            </tr>
                            <tr>
                                <td>3323</td>
                                <td>10/21/2013</td>
                                <td>3:00 PM</td>
                                <td>$23.71</td>
                            </tr>
                            <tr>
                                <td>3322</td>
                                <td>10/21/2013</td>
                                <td>2:49 PM</td>
                                <td>$8345.23</td>
                            </tr>
                            <tr>
                                <td>3321</td>
                                <td>10/21/2013</td>
                                <td>2:23 PM</td>
                                <td>$245.12</td>
                            </tr>
                            <tr>
                                <td>3320</td>
                                <td>10/21/2013</td>
                                <td>2:15 PM</td>
                                <td>$5663.54</td>
                            </tr>
                            <tr>
                                <td>3319</td>
                                <td>10/21/2013</td>
                                <td>2:13 PM</td>
                                <td>$943.45</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            <!-- /.table-responsive -->
        </div>
        <!-- /.col-lg-4 (nested) -->
        <div class="col-lg-8">
            <div id="morris-bar-chart"></div>
        </div>
        <!-- /.col-lg-8 (nested) -->
         </div>
         <!-- /.row -->
        </div>
        <!-- /.panel-body -->
	{% endif %}
	<!-- Fin Empresa Facebook -->
	<!-- Empresa Apple -->
	    {% if nom_empr == 'AAPL' or nom_empr == 'todas' %}
	    <div class="panel-body">
        <div class="row">
            <div class="col-lg-12">
                <div class="table-responsive">
                    <table class="table table-bordered table-hover table-striped">
                        <thead>
                        <tr>
                            <th>Empresa Apple</th>
                            <th>Cotización del día</th>
                            <th>Apertura</th>
                            <th>Cierre</th>
                        </tr>
                        </thead>
                        <tbody>
                            <li><a href="{{path('cotizaciones', {'nom_empr':'FB'})}}">Facebook</a></li>
                            
                        </tbody>
                </table>
            </div>
            <!-- /.table-responsive -->
        </div>
        <!-- /.col-lg-4 (nested) -->
        <div class="col-lg-8">
            <div id="morris-bar-chart"></div>
        </div>
        <!-- /.col-lg-8 (nested) -->
         </div>
         <!-- /.row -->
        </div>
        <!-- /.panel-body -->
	    {% endif %}
        <!-- Fin Empresa Apple -->
	<div class="col-lg-8 mb-2">
		<div class="row">
		   	<div class="col-lg-4 col-sm-2 mb-10">
        	<p>
		        <li><a href="{{path('cotizaciones', {'nom_empr':'FB'})}}">Facebook</a></li>
			</p>
	    	<p>
              <li><a href="{{path('cotizaciones', {'nom_empr':'AAPL'})}}">Apple</a></li>
            </p>

		  <!-- Empresa Microsoft -->
          {% if nom_empr == 'MSFT' or nom_empr == 'todas' %}
          	<p>
		        <li><a href="{{path('cotizaciones', {'nom_empr':'MSFT'})}}">Microsoft</a></li>
		    </p>
		   {% endif %}
		  <!-- Fin Empresa Microsoft -->
          <!-- Empresa Google -->
          {% if nom_empr == 'GOOGL' or nom_empr == 'todas' %}
          	<p>
		        <li><a href=getAlphaVantagedata();>Google</a></li>
		    </p>
		  {% endif %}
		  <!-- Fin Empresa Google -->
		  <!-- Empresa Amazon -->
          {% if nom_empr == 'AMZN' or nom_empr == 'todas' %}
          <p>
		    <li><a href="{{path('prueba')}}">Amazon</a></li>
		  </p>
		  </div>
		  {% endif %}
		  <!-- Fin Empresa Amazon -->
	      </div>
	</div>
</div>
  </div>
  <script>
        // Thanks to http://www.alphavantage.co/
        let apiKey;
        let symbol;
        init();
        function init() {
            apiKey = localStorage.getItem('apiKey');
            inpApiKey.value = apiKey ? apiKey : '';
        }
            function getAlphaVantagedata() {
            const func = selFunction.value; //'function is a reserved word
            const size = selSize.value;
            const type = selType.value;
            const interval = selInterval.value;
            symbol = inpSymbol.value;
            const demo = symbol === 'MSFT' && apiKey === 'demo' ? true : false;
            if (demo === true) {
                url = 'https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=MSFT&interval=1min&apikey=demo';
            } else {
                url = 'https://www.alphavantage.co/query?function=' + func +
                    '&symbol=' + symbol +
                    '&interval=' + interval +
                    '&outputsize=' + size +
                    '&datatype=' + type +
                    '&apikey=' + apiKey;
            }
            requestFile(url);
        }
        function requestFile(url) {
            const xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.onerror = function (xhr) { console.log('error:', xhr); };
            xhr.onprogress = function (xhr) { console.log('bytes loaded:', xhr.loaded); }; /// or something
            xhr.onload = callback;
            xhr.send(null);
            function callback(xhr) {
                const response = xhr.target.response;
                divContents.innerText = response;
                if (response.slice(0, 1) !== '{') { return; } // not a json file
                const json = JSON.parse(response);
                console.log('json', json);
            }
        }
        function setInterval() {
            spnInterval.style.display = selFunction.value !== 'TIME_SERIES_INTRADAY' ? 'none' : '';
        }
        function saveDataToFile() {
            const blob = new Blob([divContents.innerText]);
            let a = document.body.appendChild(document.createElement('a'));
            a.href = window.URL.createObjectURL(blob);
            a.download = symbol + '.txt';
            a.click();
            a = null;
        }
        function setStorage() {
            apiKey = inpApiKey.value;
            localStorage.setItem('apiKey', apiKey);
        }
        function getStorage() {
            apiKey = localStorage.getItem('apiKey');
        }
    </script>
      <!-- fin del conteiner -->
{% endblock %}

